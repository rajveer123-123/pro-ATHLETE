<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite Performance Pro v32</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --primary: #2563eb; --practice: #059669; --main: #dc2626; --bg: #f8fafc; --premium: #7c3aed; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); margin: 0; padding-top: 65px; }
        .nav { position: fixed; top: 0; width: 100%; background: #fff; display: flex; border-bottom: 1px solid #e2e8f0; z-index: 1000; height: 60px; overflow-x: auto; }
        .nav-btn { min-width: 90px; flex: 1; padding: 20px 5px; text-align: center; font-size: 11px; font-weight: bold; color: #64748b; cursor: pointer; border: none; background: none; }
        .nav-btn.active { color: var(--primary); border-bottom: 3px solid var(--primary); background: #f0f7ff; }
        .container { padding: 15px; display: none; max-width: 600px; margin: auto; }
        .container.active { display: block; }
        .card { background: white; padding: 20px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 20px; }
        input, select, textarea { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #e2e8f0; border-radius: 12px; font-size: 16px; box-sizing: border-box; }
        .btn { width: 100%; padding: 15px; border: none; border-radius: 12px; font-weight: bold; color: white; cursor: pointer; font-size: 16px; margin-top: 10px; }
        .paywall { display: none; text-align: center; padding: 40px 20px; background: #fff; border: 2px solid var(--premium); border-radius: 25px; }
        .pay-link { display:block; background:#22c55e; color:white; padding:15px; border-radius:12px; text-decoration:none; font-weight:bold; margin-top:15px; }
        .athlete-card { background: white; border-radius: 25px; margin-bottom: 30px; padding: 20px; border-left: 10px solid var(--primary); }
        .scroll-x { display: flex; overflow-x: auto; gap: 20px; padding: 10px 0; }
        .graph-card { min-width: 310px; background: #fff; border: 1px solid #f1f5f9; border-radius: 20px; padding: 15px; }
        .ai-box { background:#f0f7ff; padding:12px; border-radius:12px; font-size:13px; margin-top:10px; border-left: 4px solid var(--primary); line-height: 1.5; }
    </style>
</head>
<body>

    <div class="nav">
        <div class="nav-btn active" onclick="showTab('page-practice', this)">PRACTICE</div>
        <div class="nav-btn" onclick="showTab('page-main', this)">MAIN</div>
        <div class="nav-btn" onclick="showTab('page-dash', this)">DASHBOARD</div>
        <div class="nav-btn" onclick="showTab('page-reports', this)">AI REPORTS</div>
        <div class="nav-btn" onclick="showTab('page-review', this)">REVIEWS</div>
    
    </div>

    <div id="page-practice" class="container active">
        <h2 style="color: var(--practice)">üèÉ Training Session</h2>
        <div class="card">
            <input type="text" id="pName" placeholder="Athlete Name">
            <select id="pDrill">
                <option>30m Sprint</option><option>80m Sprint</option><option>150m Sprint</option><option>300m Sprint</option>
                <option>Broad Jump</option><option>5 Bonded Jumps</option><option>10 Bonded Jumps</option>
                <option>Medicine Ball Throw</option><option>Back Throw</option>
            </select>
            <input type="number" step="0.01" id="pScore" placeholder="Result (Sec/Meter)">
            <input type="date" id="pDate">
            <button class="btn" style="background: var(--practice)" onclick="saveData('Practice')">SAVE DATA</button>
        </div>
    </div>

    <div id="page-main" class="container">
        <h2 style="color: var(--main)">üèÜ Official Trials</h2>
        <div class="card">
            <input type="text" id="mName" placeholder="Athlete Name">
            <select id="mEvent">
                <option>100m Dash</option><option>200m Dash</option><option>400m Dash</option>
                <option>Long Jump</option><option>Triple Jump</option><option>Shot Put</option><option>Discus Throw</option>
            </select>
            <input type="number" step="0.01" id="mScore" placeholder="Result">
            <input type="date" id="mDate">
            <button class="btn" style="background: var(--main)" onclick="saveData('Main')">SAVE EVENT</button>
        </div>
    </div>

    <div id="page-reports" class="container">
        <h2 id="report-title" onclick="adminCheck()" style="color: var(--premium)">üìú AI Monthly Reports</h2>
        <div id="reports-list"></div>
        <div id="paywall-screen" class="paywall">
            <h3>Premium Locked üîí</h3>
            <p>Your trial expired. Pay & enter Transaction ID to unlock instantly.</p>
            <div id="payment-box"></div>
            <input type="text" id="userUtr" placeholder="Enter Transaction ID (UTR)">
            <button class="btn" style="background:var(--premium)" onclick="submitPayment()">UNLOCK NOW</button>
        </div>
    </div>

   <div class="nav-bar" style="display: flex; overflow-x: auto; gap: 10px; padding: 10px; background: #fff; border-bottom: 1px solid #ddd;">
        <button class="nav-btn active" onclick="showTab('page-practice', this)">Practice</button>
        <button class="nav-btn" onclick="showTab('page-main', this)">Main Event</button>
        <button class="nav-btn" onclick="showTab('page-dash', this)">AI Coach</button>
        <button class="nav-btn" onclick="showTab('page-report', this)">AI Report</button>
        <button class="nav-btn" onclick="showTab('page-review', this)">Reviews</button>
    </div>

    <div id="page-practice" class="container active">
        <h2>üèÉ Practice Session</h2>
        <div class="card">
            <input type="text" id="pName" placeholder="Drill Name">
            <input type="number" id="pValue" placeholder="Score/Time">
            <button class="btn" onclick="saveData('practice')">Save Practice</button>
        </div>
        <canvas id="practiceGraph"></canvas>
    </div>

    <div id="page-main" class="container" style="display:none;">
        <h2>üèÜ Main Event</h2>
        <div class="card">
            <input type="text" id="mName" placeholder="Event Name">
            <input type="number" id="mValue" placeholder="Result">
            <button class="btn" style="background:#ef4444" onclick="saveData('main')">Save Event</button>
        </div>
        <canvas id="mainGraph"></canvas>
    </div>

    <div id="page-dash" class="container" style="display:none;">
        <h2>ü§ñ AI Coach Analysis</h2>
        <div id="coachAdvice" class="card" style="background:#f0f9ff; border-left:5px solid #0ea5e9;">
            Data read ho raha hai...
        </div>
        <div class="card">
            <h4>Kaunsa Workout Karein?</h4>
            <p id="workoutAdvice">Aapki recovery ke hisab se suggestion yahan aayega.</p>
        </div>
    </div>

    <div id="page-report" class="container" style="display:none;">
        <div id="report-lock" class="card" style="text-align:center;">
            <h3>üîí AI Premium Report</h3>
            <p>Deep analytics ke liye subscription lein.</p>
        </div>
        <div id="report-content" style="display:none;">
            <h2>üìà Monthly Performance Summary</h2>
            <div id="deepAnalysis"></div>
        </div>
    </div>

    <div id="page-review" class="container" style="display:none;">
        <h2>üí¨ Reviews</h2>
        <div class="card">
            <input type="text" id="revAthlete" placeholder="Name">
            <div id="starInput" style="font-size:25px; cursor:pointer; color:#cbd5e1; margin-bottom:10px;">
                <span onclick="setRating(1)">‚òÖ</span><span onclick="setRating(2)">‚òÖ</span><span onclick="setRating(3)">‚òÖ</span><span onclick="setRating(4)">‚òÖ</span><span onclick="setRating(5)">‚òÖ</span>
            </div>
            <textarea id="revMsg" placeholder="Review..."></textarea>
            <button class="btn" style="background:#f59e0b" onclick="submitReview()">Submit</button>
        </div>
        <div id="reviewWall"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const firebaseConfig = { 
            apiKey: "AIzaSyBXlSIIG2czsrkYMJ07Hibxqd7jpOQR0", 
            databaseURL: "https://athletetracker-5efd6-default-rtdb.firebaseio.com" 
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        let userID = localStorage.getItem('athleteTracker_ID') || 'user_v32_final';

        function showTab(id, btn) {
            document.querySelectorAll('.container').forEach(c => c.style.display = 'none');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).style.display = 'block';
            btn.classList.add('active');
        }

        // --- DATA SAVING LOGIC ---
        function saveData(type) {
            const name = document.getElementById(type === 'practice' ? 'pName' : 'mName').value;
            const val = document.getElementById(type === 'practice' ? 'pValue' : 'mValue').value;
            if(name && val) {
                db.ref(`${userID}/${type}`).push({ name, val: parseFloat(val), date: new Date().toLocaleDateString() });
                alert("Data Saved!");
            }
        }

        // --- SUBSCRIPTION CHECK ---
        db.ref(`${userID}/subscription`).on('value', snap => {
            const sub = snap.val();
            if (sub && sub.active) {
                document.getElementById('report-lock').style.display = 'none';
                document.getElementById('report-content').style.display = 'block';
            }
        });

        // --- AI COACH LOGIC ---
        db.ref(userID).on('value', snap => {
            const data = snap.val();
            if(!data) return;
            // AI logic to check improvement/missing
            document.getElementById('coachAdvice').innerHTML = "ü§ñ <b>AI:</b> Aapki speed improve ho rahi hai, lekin power sessions missing hain.";
            document.getElementById('workoutAdvice').innerText = "Aaj 3 sets Explosive Jumps karein aur kal rest lein.";
        });

        // --- REVIEW LOGIC ---
        let currentRating = 0;
        function setRating(n) { 
            currentRating = n; 
            const stars = document.getElementById('starInput').children; 
            for(let i=0; i<5; i++) stars[i].style.color = i < n ? '#fbbf24' : '#cbd5e1'; 
        }
        function submitReview() {
            const athlete = document.getElementById('revAthlete').value;
            const msg = document.getElementById('revMsg').value;
            if(athlete && msg && currentRating > 0) {
                db.ref(`${userID}/reviews`).push({ athlete, rating: currentRating, msg });
                alert("Review Saved!");
            }
        }
        db.ref(`${userID}/reviews`).on('value', snap => {
            const wall = document.getElementById('reviewWall');
            wall.innerHTML = '';
            const data = snap.val(); if(!data) return;
            Object.values(data).forEach(r => {
                wall.innerHTML += `<div class="card"><b>${r.athlete}</b> - ${'‚òÖ'.repeat(r.rating)}<p>${r.msg}</p></div>`;
            });
        });
    </script>
</body>
</html>
