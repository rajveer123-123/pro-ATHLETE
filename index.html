<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Athlete Academy v81</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --primary: #2563eb; --practice: #059669; --main: #dc2626; --premium: #7c3aed; --bg: #f8fafc; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding-bottom: 75px; }
        .ath-bar { display: flex; overflow-x: auto; padding: 12px; background: #fff; gap: 15px; border-bottom: 1px solid #ddd; }
        .ath-chip { min-width: 65px; text-align: center; cursor: pointer; opacity: 0.5; }
        .ath-chip.active { opacity: 1; color: var(--primary); font-weight: bold; }
        .ath-chip img { width: 50px; height: 50px; border-radius: 50%; border: 2px solid #ccc; object-fit: cover; }
        .container { padding: 15px; max-width: 800px; margin: auto; display: none; }
        .container.active { display: block; }
        .card { background: #fff; padding: 15px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .graph-slider { display: flex; overflow-x: auto; gap: 15px; padding-bottom: 10px; }
        .graph-card { min-width: 85%; background: #fff; padding: 15px; border-radius: 20px; border: 1px solid #eee; }
        input, select, textarea { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 12px; }
        .btn { width: 100%; padding: 15px; border: none; border-radius: 12px; font-weight: bold; color: #fff; cursor: pointer; }
        .nav { position: fixed; bottom: 0; width: 100%; background: #fff; display: flex; border-top: 1px solid #ddd; height: 65px; }
        .nav-btn { flex: 1; border: none; background: none; font-size: 10px; font-weight: bold; color: #666; }
        .nav-btn.active { color: var(--primary); }
        .del-btn { background: #ff4444; color: white; border: none; padding: 4px 8px; border-radius: 6px; font-size: 10px; cursor: pointer; }
        .pay-wall { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 9999; display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 20px; overflow-y: auto; }
        .ai-box { background: #eff6ff; border-left: 4px solid var(--primary); padding: 10px; border-radius: 8px; font-size: 13px; margin-top: 10px; }
    </style>
</head>
<body>

    <div id="payWall" class="pay-wall">
        <h2 style="color:var(--main)">Trial Expired!</h2>
        <div class="card">
            <h4>Scan to Pay ‚Çπ499</h4>
            <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=upi://pay?pa=your-upi-id@okicici" width="150">
            <p>Enter Transaction ID below:</p>
            <input type="text" id="txId" placeholder="12-digit Ref No.">
            <button class="btn" style="background:var(--primary)" onclick="activate()">ACTIVATE PREMIUM</button>
        </div>
    </div>

    <div class="ath-bar" id="athBar"></div>

    <div id="app-content">
        <div id="d-page" class="container active">
            <h2 id="athName" style="text-align:center;">Athlete Dash</h2>
            <div id="aiSuggestion" class="ai-box"><b>AI Suggestion:</b> Add data to see coaching tips.</div>
            <div id="dashboard-graphs" class="graph-slider"></div>
        </div>

        <div id="i-page" class="container">
            <div class="card">
                <h3>New Session</h3>
                <select id="cat" onchange="upd()"><option value="Practice">Practice (12)</option><option value="Main">Main (13)</option></select>
                <select id="sub"></select>
                <input type="number" step="0.01" id="sc" placeholder="Score"><input type="date" id="dt">
                <button class="btn" style="background: var(--practice)" onclick="save()">SAVE SESSION</button>
            </div>
            <div id="p-slider" class="graph-slider"></div>
            <div id="m-slider" class="graph-slider"></div>
        </div>

        <div id="v-page" class="container">
            <div class="card">
                <h3>Global Reviews (<span id="count">0</span>)</h3>
                <select id="stars"><option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option><option value="4">‚≠ê‚≠ê‚≠ê‚≠ê</option><option value="3">‚≠ê‚≠ê‚≠ê</option></select>
                <textarea id="rev" placeholder="How is the coaching?"></textarea>
                <button class="btn" style="background:var(--primary)" onclick="post()">SUBMIT REVIEW</button>
            </div>
            <div id="wall"></div>
        </div>
    </div>

    <div class="nav">
        <button class="nav-btn active" onclick="tab('d-page',this)">üìä DASH</button>
        <button class="nav-btn" onclick="tab('i-page',this)">üèÉ TRAINING</button>
        <button class="nav-btn" onclick="tab('v-page',this)">üí¨ REVIEWS</button>
        <button class="nav-btn" onclick="addAth()">üë§ +ATHLETE</button>
    </div>

<script>
    // Yahan apni Firebase details dalein
    const fb = { apiKey: "AIzaSy...", databaseURL: "https://your-app.firebaseio.com" };
    firebase.initializeApp(fb); const db = firebase.database(); const ID = 'academy_v81'; let active = "";

    function upd() {
        const c = document.getElementById('cat').value; const s = document.getElementById('sub');
        const l = c==='Practice' ? ['30m','40m','80m','120m','150m','180m','300m','800m','Broad Jump','Standing Triple','5 Bounded','10 Bounded'] : ['100m','200m','400m','800m','1500m','3km','5km','Long Jump','High Jump','Triple Jump','Javelin','Discus','Shot Put'];
        s.innerHTML = l.map(i=>`<option value="${i}">${i}</option>`).join('');
    } upd();

    function addAth() { const n = prompt("Name:"); const p = prompt("Photo URL:"); if(n) db.ref(`${ID}/athletes/${n}`).set({name:n, photo:p||"https://cdn-icons-png.flaticon.com/512/3135/3135715.png", regDate: Date.now(), premium: false}); }

    function loadAth() {
        db.ref(`${ID}/athletes`).on('value', snap => {
            const b = document.getElementById('athBar'); b.innerHTML = '';
            snap.forEach(c => {
                const a = c.val(); if(!active) sel(a.name);
                const d = document.createElement('div'); d.className = `ath-chip ${active===a.name?'active':''}`;
                d.onclick = () => sel(a.name); d.innerHTML = `<img src="${a.photo}"><br><small>${a.name}</small>`; b.appendChild(d);
            });
        });
    }

    function sel(n) {
        active = n; document.getElementById('athName').innerText = n;
        db.ref(`${ID}/athletes/${n}`).once('value', s => {
            const a = s.val(); const days = Math.ceil((30*24*60*60*1000 - (Date.now()-a.regDate))/(1000*60*60*24));
            document.getElementById('payWall').style.display = (!a.premium && days <= 0) ? 'flex' : 'none';
        });
        loadData(n);
    }

    function loadData(n) {
        db.ref(`${ID}/data/${n}`).on('value', snap => {
            const ps=document.getElementById('p-slider'), ms=document.getElementById('m-slider'), ds=document.getElementById('dashboard-graphs');
            ps.innerHTML=ms.innerHTML=ds.innerHTML=''; const d = snap.val(); if(!d) return;
            for(let c in d) { for(let e in d[c]) {
                const logs = Object.entries(d[c][e]).map(([k,v])=>({k,...v})).sort((a,b)=>a.ts-b.ts);
                const gid = `g-${c}-${e}`.replace(/\s/g,''); const card = document.createElement('div'); card.className = 'graph-card';
                let t = `<div style="margin-top:10px; border-top:1px solid #eee;">`;
                logs.forEach(l => { t += `<div style="display:flex; justify-content:space-between; padding:5px 0; border-bottom:1px solid #f9f9f9;"><span>${l.date}: <b>${l.score}</b></span><button class="del-btn" onclick="del('${c}','${e}','${l.k}')">X</button></div>`; });
                card.innerHTML = `<b>${e}</b><canvas id="${gid}"></canvas>${t}</div>`;
                if(c === 'Practice') ps.appendChild(card); else ms.appendChild(card);
                ds.appendChild(card.cloneNode(true));
                setTimeout(() => new Chart(document.getElementById(gid), {type:'line', data:{labels:logs.map(l=>l.date), datasets:[{label:e, data:logs.map(l=>l.score), borderColor:'#2563eb'}]}}), 500);
            }}
            document.getElementById('aiSuggestion').innerHTML = `<b>AI Coach:</b> Improvement seen in last sessions. Focus on recovery today!`;
        });
    }

    function save() { const c=document.getElementById('cat').value, e=document.getElementById('sub').value, s=document.getElementById('sc').value, d=document.getElementById('dt').value; if(active && s && d) db.ref(`${ID}/data/${active}/${c}/${e}`).push({score:s, date:d, ts:Date.now()}); }
    function del(c,e,k) { if(confirm("Delete this session?")) db.ref(`${ID}/data/${active}/${c}/${e}/${k}`).remove(); }
    function activate() { const id = document.getElementById('txId').value; if(id) { db.ref(`${ID}/athletes/${active}`).update({premium: true}); location.reload(); } }
    function tab(id, b) { document.querySelectorAll('.container').forEach(c=>c.classList.remove('active')); document.querySelectorAll('.nav-btn').forEach(n=>n.classList.remove('active')); document.getElementById(id).classList.add('active'); b.classList.add('active'); }
    function post() { db.ref(`${ID}/reviews`).push({name:active, stars:document.getElementById('stars').value, msg:document.getElementById('rev').value}); }
    db.ref(`${ID}/reviews`).on('value', s => { 
        const w=document.getElementById('wall'); w.innerHTML=''; let count=0;
        s.forEach(r=>{ const d=r.val(); count++; w.innerHTML=`<div class="card"><b>${d.name}</b> ${d.stars}<p>${d.msg}</p></div>`+w.innerHTML; });
        document.getElementById('count').innerText = count;
    });
    loadAth();
</script>
</body>
</html>
